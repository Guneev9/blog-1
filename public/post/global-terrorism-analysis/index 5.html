<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.37" />
  <meta name="author" content="Kumar Rohit Malhotra">

  
  
  
  
    
      
    
  
  <meta name="description" content="knitr::opts_chunk$set(echo=FALSE, error=FALSE, fig.path = &quot;README_figs/README-&quot;, warning = FALSE, message=FALSE)  options(warn=-1)  library(tidyr) library(dplyr) library(plotly) library(rworldmap) library(maps) library(ggmap) library(reshape2) library(raster) library(rgdal) library(rgeos)  terr = read.csv(&#39;~/Downloads/globalterrorismdb_0617dist.csv&#39;, check.names = FALSE, header = TRUE, stringsAsFactors = FALSE)  c(ncol(terr),nrow(terr)) sum(is.na(terr))#/(ncol(data)*nrow(data))  terr=rename(terr, id=eventid, year=iyear, nation=country_txt, Region=region_txt, attack=attacktype1_txt, target=targtype1_txt, weapon=weaptype1_txt, Killed=nkill, wounded=nwound)  Data cleaning We clean the data
terr$Killed=as.integer(terr$Killed) terr$wounded=as.integer(terr$wounded) terr$Killed[which(is.na(terr$Killed))] = 0 terr$wounded[which(is.na(terr$wounded))] = 0 terr$nation[terr$nation==&quot;United States&quot;] &lt;- &quot;USA&quot; terr$nation[terr$nation==&quot;United Kingdom&quot;] &lt;- &quot;UK&quot; terr$nation[terr$nation==&quot;People&#39;s Republic of the Congo&quot;] &lt;- &quot;Republic of Congo&quot; terr$nation[terr$nation==&quot;Bosnia-Herzegovina&quot;] &lt;- &quot;Bosnia and Herzegovina&quot; terr$nation[terr$nation==&quot;Slovak Republic&quot;] &lt;- &quot;Slovakia&quot;  global_t &lt;- terr %&gt;% group_by(year,nation,Region) %&gt;% summarize(Total=n()) global_y &lt;- global_t%&gt;%group_by(year)%&gt;%summarize(Total=sum(Total)) global_attacks &lt;- global_t %&gt;% group_by(nation) %&gt;% summarize(Total=sum(Total)) %&gt;% arrange(desc(Total)) #%&gt;%filter(Total&gt;300) #global_attacks$Total[which(is.">

  
  <link rel="alternate" hreflang="en-us" href="/post/global-terrorism-analysis/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-117115991-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Kumar&#39;s blog">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Kumar&#39;s blog">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/global-terrorism-analysis/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@krohitm">
  <meta property="twitter:creator" content="@krohitm">
  
  <meta property="og:site_name" content="Kumar&#39;s blog">
  <meta property="og:url" content="/post/global-terrorism-analysis/">
  <meta property="og:title" content="Global Terrorism analysis | Kumar&#39;s blog">
  <meta property="og:description" content="knitr::opts_chunk$set(echo=FALSE, error=FALSE, fig.path = &quot;README_figs/README-&quot;, warning = FALSE, message=FALSE)  options(warn=-1)  library(tidyr) library(dplyr) library(plotly) library(rworldmap) library(maps) library(ggmap) library(reshape2) library(raster) library(rgdal) library(rgeos)  terr = read.csv(&#39;~/Downloads/globalterrorismdb_0617dist.csv&#39;, check.names = FALSE, header = TRUE, stringsAsFactors = FALSE)  c(ncol(terr),nrow(terr)) sum(is.na(terr))#/(ncol(data)*nrow(data))  terr=rename(terr, id=eventid, year=iyear, nation=country_txt, Region=region_txt, attack=attacktype1_txt, target=targtype1_txt, weapon=weaptype1_txt, Killed=nkill, wounded=nwound)  Data cleaning We clean the data
terr$Killed=as.integer(terr$Killed) terr$wounded=as.integer(terr$wounded) terr$Killed[which(is.na(terr$Killed))] = 0 terr$wounded[which(is.na(terr$wounded))] = 0 terr$nation[terr$nation==&quot;United States&quot;] &lt;- &quot;USA&quot; terr$nation[terr$nation==&quot;United Kingdom&quot;] &lt;- &quot;UK&quot; terr$nation[terr$nation==&quot;People&#39;s Republic of the Congo&quot;] &lt;- &quot;Republic of Congo&quot; terr$nation[terr$nation==&quot;Bosnia-Herzegovina&quot;] &lt;- &quot;Bosnia and Herzegovina&quot; terr$nation[terr$nation==&quot;Slovak Republic&quot;] &lt;- &quot;Slovakia&quot;  global_t &lt;- terr %&gt;% group_by(year,nation,Region) %&gt;% summarize(Total=n()) global_y &lt;- global_t%&gt;%group_by(year)%&gt;%summarize(Total=sum(Total)) global_attacks &lt;- global_t %&gt;% group_by(nation) %&gt;% summarize(Total=sum(Total)) %&gt;% arrange(desc(Total)) #%&gt;%filter(Total&gt;300) #global_attacks$Total[which(is.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-02-28T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-02-28T00:00:00&#43;00:00">
  

  

  <title>Global Terrorism analysis | Kumar&#39;s blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Kumar&#39;s blog</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Global Terrorism analysis</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-02-28 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Feb 28, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Kumar Rohit Malhotra">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/global-terrorism-analysis/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/terrorism">terrorism</a
    >, 
    
    <a href="/categories/data-analysis">data analysis</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Global%20Terrorism%20analysis&amp;url=%2fpost%2fglobal-terrorism-analysis%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fglobal-terrorism-analysis%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fglobal-terrorism-analysis%2f&amp;title=Global%20Terrorism%20analysis"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fglobal-terrorism-analysis%2f&amp;title=Global%20Terrorism%20analysis"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Global%20Terrorism%20analysis&amp;body=%2fpost%2fglobal-terrorism-analysis%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      

<pre><code class="language-r setup, include=FALSE, echo=FALSE">knitr::opts_chunk$set(echo=FALSE, 
                      error=FALSE,
                      fig.path = &quot;README_figs/README-&quot;,
                      warning = FALSE,
                      message=FALSE)
</code></pre>

<pre><code class="language-r">options(warn=-1)
</code></pre>

<pre><code class="language-r">library(tidyr)
library(dplyr)
library(plotly)
library(rworldmap)
library(maps)
library(ggmap)
library(reshape2)
library(raster)
library(rgdal)
library(rgeos)

</code></pre>

<pre><code class="language-r">terr = read.csv('~/Downloads/globalterrorismdb_0617dist.csv', check.names = FALSE, header = TRUE, stringsAsFactors = FALSE)
</code></pre>

<pre><code class="language-r">c(ncol(terr),nrow(terr))
sum(is.na(terr))#/(ncol(data)*nrow(data))
</code></pre>

<pre><code class="language-r">terr=rename(terr, id=eventid, year=iyear, nation=country_txt, 
            Region=region_txt, attack=attacktype1_txt,
            target=targtype1_txt, weapon=weaptype1_txt, 
            Killed=nkill, wounded=nwound)
</code></pre>

<h2 id="data-cleaning">Data cleaning</h2>

<p>We clean the data</p>

<pre><code class="language-r">terr$Killed=as.integer(terr$Killed)
terr$wounded=as.integer(terr$wounded)

terr$Killed[which(is.na(terr$Killed))] = 0
terr$wounded[which(is.na(terr$wounded))] = 0


terr$nation[terr$nation==&quot;United States&quot;] &lt;- &quot;USA&quot;
terr$nation[terr$nation==&quot;United Kingdom&quot;] &lt;- &quot;UK&quot;
terr$nation[terr$nation==&quot;People's Republic of the Congo&quot;] &lt;- &quot;Republic of Congo&quot;
terr$nation[terr$nation==&quot;Bosnia-Herzegovina&quot;] &lt;- &quot;Bosnia and Herzegovina&quot;
terr$nation[terr$nation==&quot;Slovak Republic&quot;] &lt;- &quot;Slovakia&quot;
</code></pre>

<pre><code class="language-r">global_t &lt;- 
  terr %&gt;%
  group_by(year,nation,Region) %&gt;%
  summarize(Total=n())

global_y &lt;- global_t%&gt;%group_by(year)%&gt;%summarize(Total=sum(Total))
global_attacks &lt;- 
  global_t %&gt;%
  group_by(nation) %&gt;%
  summarize(Total=sum(Total)) %&gt;% 
  arrange(desc(Total))
#%&gt;%filter(Total&gt;300)
#global_attacks$Total[which(is.na(global_attacks$Total))] = 0

attach(global_attacks)
global_n &lt;- global_attacks[order(-Total),]
detach(global_attacks)
</code></pre>

<pre><code class="language-r">global_kills_years &lt;- terr%&gt;%group_by(year)%&gt;%summarize(killed=sum(Killed))
global_wound_years &lt;- terr%&gt;%group_by(year)%&gt;%summarize(wounded=sum(wounded))
globe &lt;- 
  global_kills_years %&gt;% 
  inner_join(global_wound_years, by=&quot;year&quot;)

df &lt;- melt(globe, &quot;year&quot;)
df=rename(df, effect=variable)
</code></pre>

<pre><code class="language-r">world &lt;- map_data(&quot;world&quot;)
global &lt;- rename(terr, long=longitude, lat=latitude)
</code></pre>

<pre><code class="language-r">#helper theme for common visualizations
ditch_the_axes &lt;- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank()
  )
</code></pre>

<pre><code class="language-r">#helper function to visualize maps for varaibles for counts
visualize_count_map &lt;- function(global_table, title){
  global_table &lt;- 
    global_table %&gt;%
    rename(region=nation)

  #join the data found with world data
  world_table &lt;- right_join(global_table, world, by=&quot;region&quot;)
  world_table$Total[which(is.na(world_table$Total))]=0
  
  g &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(legend.position = &quot;none&quot;, panel.background = NULL)+
  geom_polygon(data = world_table, aes(label = region, fill = Total), color =&quot;white&quot;) +
  scale_fill_gradientn(colours=c(&quot;#e1eec3&quot;,&quot;#f05053&quot;))+
  ggtitle(title)

  ggplotly(g, width = 850, height = 480)
}
</code></pre>

<p>#Let&rsquo;s look at the number of terrorist attacks across the globe.</p>

<pre><code class="language-r">visualize_count_map(global_attacks, &quot;Number of terrorist attacks around the world&quot;)
</code></pre>

<p>#Let&rsquo;s look at the number of people killed across the global in terrorist atttacks.</p>

<pre><code class="language-r">global_kills &lt;- 
  global %&gt;% 
  group_by(nation) %&gt;% 
  summarise(Total = sum(Killed))

visualize_count_map(global_kills, &quot;Number of people killed around the world&quot;)
</code></pre>

<pre><code class="language-r">global_wound &lt;- 
  global %&gt;% 
  group_by(nation) %&gt;% 
  summarise(Total = sum(wounded))

visualize_count_map(global_wound, &quot;Number of people wounded around the world&quot;)
</code></pre>

<p>#Let&rsquo;s look at the type of weapons used the most in terrorist attacks across the globe.</p>

<pre><code class="language-r">#get weapon most used in each nation
global_weapons_max_type &lt;- 
  terr[c('nation', 'weapon')] %&gt;% 
  group_by(nation, weapon) %&gt;%
  summarize(Total=n()) %&gt;%
  filter(Total==max(Total)) %&gt;%
  group_by(nation)

global_weapons_max_type &lt;- 
  global_weapons_max_type %&gt;%
  rename(region=nation)

#join the data found with world data
world_weapons &lt;- right_join(global_weapons_max_type, world, by=&quot;region&quot;)
world_weapons$weapon[which(is.na(world_weapons$weapon))]=&quot;Unknown&quot;
</code></pre>

<pre><code class="language-r">num_unique_weapons &lt;- length(unique(world_weapons$weapon))
                             
g4 &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(panel.background = NULL)+
  geom_polygon(data = world_weapons, aes(label = region, fill = factor(weapon)), color =&quot;white&quot;) +
  scale_fill_manual(values = c(rainbow(num_unique_weapons, 
                                       s = 0.6, 
                                       v = 0.8, start = 0, 
                                       end = max(1, num_unique_weapons - 1)/num_unique_weapons, 
                                       alpha = 0.7)))+
  ggtitle(&quot;Most used weapons in terrorist attacks around the world&quot;)

ggplotly(g4, width = 850, height = 480)
</code></pre>

<pre><code class="language-r">visualize_factor_map &lt;- function(global_table, factor, title) {
  global_attack_max_type &lt;- 
    global_attack_max_type %&gt;%
    rename(region=nation)

  #join the data found with world data
  world_attack_types &lt;- right_join(global_attack_max_type, world, by=&quot;region&quot;)
  world_attack_types$attack[which(is.na(world_attack_types$attack))]=&quot;Unknown&quot;
  num_unique_attacks &lt;- length(unique(global_attack_max_type$attack))
                             
  g5 &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
    coord_fixed(1.3) +
    ditch_the_axes+
    theme(panel.background = NULL)+
    geom_polygon(data = world_attack_types, aes(label = region, fill = factor(attack)), color =&quot;white&quot;) +
    scale_fill_manual(values = c(rainbow(num_unique_attacks, 
                                       s = 0.6, 
                                       v = 0.8, start = 0, 
                                       end = max(1, num_unique_attacks - 1)/num_unique_attacks, 
                                       alpha = 0.7)))+
  ggtitle(&quot;Most particular type of attacks in different countries&quot;)

ggplotly(g5, width = 900, height = 480)
}
</code></pre>

<p>#Let&rsquo;s look at the most particular type of attacks in different countries.</p>

<pre><code class="language-r">#get weapon most used in each nation
global_attack_max_type &lt;- 
  terr[c('nation', 'attack')] %&gt;% 
  group_by(nation, attack) %&gt;%
  summarize(Total=n()) %&gt;%
  filter(Total==max(Total)) %&gt;%
  group_by(nation)

global_attack_max_type &lt;- 
  global_attack_max_type %&gt;%
  rename(region=nation)

#join the data found with world data
world_attack_types &lt;- right_join(global_attack_max_type, world, by=&quot;region&quot;)
world_attack_types$attack[which(is.na(world_attack_types$attack))]=&quot;Unknown&quot;
</code></pre>

<pre><code class="language-r">num_unique_attacks &lt;- length(unique(global_attack_max_type$attack))
                             
g5 &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(panel.background = NULL)+
  geom_polygon(data = world_attack_types, aes(label = region, fill = factor(attack)), color =&quot;white&quot;) +
  scale_fill_manual(values = c(rainbow(num_unique_attacks, 
                                       s = 0.6, 
                                       v = 0.8, start = 0, 
                                       end = max(1, num_unique_attacks - 1)/num_unique_attacks, 
                                       alpha = 0.7)))+
  ggtitle(&quot;Most particular type of attacks in different countries&quot;)

ggplotly(g5, width = 900, height = 480)
</code></pre>

<p>#Let&rsquo;s look at the most attacked targets in different countries</p>

<pre><code class="language-r">#get weapon most used in each nation
global_target_max_type &lt;- 
  terr[c('nation', 'target')] %&gt;% 
  group_by(nation, target) %&gt;%
  summarize(Total=n()) %&gt;%
  filter(Total==max(Total)) %&gt;%
  group_by(nation)

global_target_max_type &lt;- 
  global_target_max_type %&gt;%
  rename(region=nation)

#join the data found with world data
world_target_types &lt;- right_join(global_target_max_type, world, by=&quot;region&quot;)
world_target_types$target[which(is.na(world_target_types$target))]=&quot;Unknown&quot;
</code></pre>

<pre><code class="language-r">num_unique_targets &lt;- length(unique(global_target_max_type$target))
                             
g6 &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(panel.background = NULL)+
  geom_polygon(data = world_target_types, aes(label = region, fill = factor(target)), color =&quot;white&quot;) +
  scale_fill_manual(values=c(terrain.colors(num_unique_targets, alpha = 0.8)))+
  ggtitle(&quot;Most particular type of targets in different countries&quot;)

ggplotly(g6, width = 900, height = 480)
</code></pre>

<p>#Most active perpetrator groups around the world</p>

<pre><code class="language-r">#get weapon most used in each nation
global_group_max_attacks &lt;- 
  terr[c('nation', 'gname')] %&gt;% 
  group_by(nation, gname) %&gt;%
  summarize(Total=n()) %&gt;%
  filter(gname!= &quot;Unknown&quot;) %&gt;%
  filter(Total==max(Total)) %&gt;%
  group_by(nation)

global_group_max_attacks &lt;- 
  global_group_max_attacks %&gt;%
  rename(region=nation)

#join the data found with world data
world_groups_attacks &lt;- right_join(global_group_max_attacks, world, by=&quot;region&quot;)
world_groups_attacks$gname[which(is.na(world_groups_attacks$gname))]=&quot;Unknown&quot;
</code></pre>

<pre><code class="language-r">num_unique_groups &lt;- length(unique(global_group_max_attacks$gname))
terrorist_group &lt;- factor(world_groups_attacks$gname)
                             
g7 &lt;- ggplot(data = world, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(legend.position = &quot;none&quot;, panel.background = NULL)+
  geom_polygon(data = world_groups_attacks, aes(label = region, fill = terrorist_group), color =&quot;white&quot;) +
  scale_fill_manual(values=c(topo.colors(num_unique_groups, alpha = 0.6)))+
  ggtitle(&quot;Most active terrorist groups around the globe&quot;)

ggplotly(g7, width = 850, height = 480)
</code></pre>

<p>#Taking a look at the international attacks</p>

<pre><code class="language-r">#get weapon most used in each nation
global_int_attacks &lt;- 
  terr[c('nation', 'INT_ANY')] %&gt;% 
  filter(INT_ANY=='1') %&gt;%
  group_by(nation) %&gt;%
  summarize(Total=n())

visualize_count_map(global_int_attacks, &quot;International attacks around the globe&quot;)
</code></pre>

<p>#Taking a look at the domestic attacks</p>

<pre><code class="language-r">#get weapon most used in each nation
global_dom_attacks &lt;- 
  terr[c('nation', 'INT_ANY')] %&gt;% 
  filter(INT_ANY=='0') %&gt;%
  group_by(nation) %&gt;%
  summarize(Total=n())

visualize_count_map(global_dom_attacks, &quot;Domestic attacks around the globe&quot;)
</code></pre>

<pre><code class="language-r">data_India &lt;- filter(terr, nation == &quot;India&quot;)
data_India &lt;- rename(data_India, long=longitude, lat=latitude)

India &lt;- filter(world, region ==&quot;India&quot;)

#US$provstate &lt;- tolower(US$provstate)

India_kills &lt;- 
  data_India %&gt;% 
  group_by(provstate) %&gt;% 
  summarise(Killed = sum(Killed))
India_kills=rename(India_kills, subregion=provstate)
</code></pre>

<pre><code class="language-r">### Get data
india &lt;- getData(&quot;GADM&quot;, country = &quot;India&quot;, level = 1)

map &lt;- fortify(india)
map$id &lt;- as.integer(map$id)

dat &lt;- data.frame(id = 1:(length(india@data$NAME_1)), state = india@data$NAME_1)
map_df &lt;- inner_join(map, dat, by = &quot;id&quot;)

centers &lt;- data.frame(gCentroid(india, byid = TRUE))
centers$state &lt;- dat$state

ggplot() +
geom_map(data = map_df, map = map_df,
         aes(map_id = id, x = long, y = lat, group = group),
         color = &quot;#ffffff&quot;, fill = &quot;#bbbbbb&quot;, size = 0.25) +
geom_text(data = centers, aes(label = state, x = x, y = y), size = 2) +
coord_map() +
labs(x = &quot;&quot;, y = &quot;&quot;, title = &quot;India State&quot;) +
  ditch_the_axes
</code></pre>

<pre><code class="language-r">India_kills = rename(India_kills, state=subregion)
</code></pre>

<pre><code class="language-r">### Get data
india &lt;- getData(&quot;GADM&quot;, country = &quot;India&quot;, level = 1)

map &lt;- fortify(india)
map$id &lt;- as.integer(map$id)

dat &lt;- data.frame(id = 1:(length(india@data$NAME_1)), state = india@data$NAME_1)
India &lt;- inner_join(map, dat, by = &quot;id&quot;)
#map_df &lt;- inner_join(map_df, India_kills, by = &quot;state&quot;)

comb_India &lt;- right_join(India_kills, India, by=&quot;state&quot;)

centers &lt;- data.frame(gCentroid(india, byid = TRUE))
centers$state &lt;- dat$state

head(India)
</code></pre>

<pre><code class="language-r">head(dat)
head(map)
head(India_kills)
head(India)
head(comb_India)
</code></pre>

<pre><code class="language-r">g2 &lt;- ggplot(data = India, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(legend.position = &quot;none&quot;, panel.background = NULL)+
  geom_polygon(data = comb_India, aes(label=state, fill = Killed), color = &quot;white&quot;) +
  scale_fill_gradientn(colours=c(&quot;#e1eec3&quot;,&quot;#f05053&quot;))+
  ggtitle(&quot;Number of people killed in India&quot;)
</code></pre>

<pre><code class="language-r">ggplotly(g2, width = 800, height = 550)
</code></pre>

<pre><code class="language-r">US&lt;-filter(terr,nation ==&quot;USA&quot;)
US &lt;- rename(US, long=longitude, lat=latitude)
</code></pre>

<pre><code class="language-r">USf &lt;- US%&gt;%
  filter(long&lt;0,lat&lt;50,lat&gt;27)%&gt;%
  filter(Killed!=0)

USA &lt;- map_data(&quot;state&quot;)
</code></pre>

<pre><code class="language-r">head(USA)
#unique(USA$group)
#unique(USA$region)
</code></pre>

<pre><code class="language-r">US$provstate &lt;- tolower(US$provstate)

USA_kills &lt;- US %&gt;% group_by(provstate) %&gt;% summarise(Killed = sum(Killed))
USA_kills=rename(USA_kills, region=provstate)
</code></pre>

<pre><code class="language-r">head(USA_kills)
</code></pre>

<pre><code class="language-r">cacopa &lt;- right_join(USA_kills, USA, by=&quot;region&quot;)
head(cacopa)
</code></pre>

<pre><code class="language-r">#g1 + geom_polygon(data = USA, fill = NA, color = &quot;white&quot;) +
#  geom_polygon(color = &quot;black&quot;, fill = NA)

g2 &lt;- ggplot(data = USA, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) +
  ditch_the_axes+
  theme(legend.position = &quot;none&quot;, panel.background = NULL)+
  geom_polygon(data = cacopa, aes(label=region, fill = Killed), color = &quot;white&quot;) +
  scale_fill_gradientn(colours=c(&quot;#e1eec3&quot;,&quot;#f05053&quot;))+
  ggtitle(&quot;Number of people killed in US&quot;)

ggplotly(g2, width = 800, height = 480)
</code></pre>

    </div>

    





    
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "krohitm" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//krohitm.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

